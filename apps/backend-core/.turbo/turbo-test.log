
> @granter/backend-core@0.1.0 test
> jest

PASS src/auth/__tests__/register.dto.spec.ts (10.687 s)
PASS src/sources/__tests__/create-source.dto.spec.ts (10.694 s)
PASS src/grants/__tests__/create-grant.dto.spec.ts (10.695 s)
PASS src/search/__tests__/search-filters.dto.spec.ts (10.901 s)
PASS src/scraper/handlers/pdf.handler.spec.ts (11.304 s)
PASS src/common/guards/__tests__/csrf.guard.spec.ts (11.341 s)
[Nest] 91250  - 01/29/2026, 8:37:14 PM   ERROR [JwtStrategy] JWT secret is missing or too short (minimum 32 chars)
[Nest] 91250  - 01/29/2026, 8:37:14 PM   ERROR [JwtStrategy] JWT secret is missing or too short (minimum 32 chars)
PASS src/auth/__tests__/jwt.strategy.spec.ts (12.543 s)
[Nest] 91294  - 01/29/2026, 8:37:14 PM    WARN [XServiceTokenGuard] Invalid X-Service-Token provided
[Nest] 91250  - 01/29/2026, 8:37:14 PM    WARN [JwtStrategy] Invalid JWT payload: missing sub
[Nest] 91250  - 01/29/2026, 8:37:14 PM    WARN [JwtStrategy] Invalid JWT payload types
[Nest] 91294  - 01/29/2026, 8:37:14 PM   ERROR [XServiceTokenGuard] SERVICE_TOKEN is not configured
PASS src/common/guards/__tests__/x-service-token.guard.spec.ts (12.632 s)
[Nest] 91294  - 01/29/2026, 8:37:14 PM    WARN [XServiceTokenGuard] Missing X-Service-Token header
[Nest] 91160  - 01/29/2026, 8:37:15 PM    WARN [PasswordService] Password too short
[Nest] 91160  - 01/29/2026, 8:37:15 PM    WARN [PasswordService] Password missing required character classes
PASS src/auth/__tests__/password.service.spec.ts (13.784 s)
PASS src/common/health/__tests__/health.controller.spec.ts (15.576 s)
PASS src/sources/__tests__/sources.service.spec.ts (15.655 s)
PASS src/profile/__tests__/profile.service.spec.ts (15.669 s)
PASS src/auth/__tests__/refresh-token-cleanup.service.spec.ts (15.677 s)
[Nest] 91155  - 01/29/2026, 8:37:17 PM     LOG [RefreshTokenCleanupService] Removed 2 stale refresh tokens
PASS src/auth/__tests__/auth.service.spec.ts (15.778 s)
PASS src/recommendations/__tests__/recommendations.service.spec.ts (15.794 s)
PASS src/auth/__tests__/auth.controller.spec.ts (15.833 s)
PASS src/search/__tests__/search.service.spec.ts (15.881 s)
PASS src/notifications/__tests__/notifications.service.spec.ts (16.183 s)
[Nest] 91242  - 01/29/2026, 8:37:18 PM   ERROR [ScraperService] ✗ GenericScraper failed: GenericScraper error
[Nest] 91242  - 01/29/2026, 8:37:18 PM   ERROR [ScraperService] ✗ All scraping methods exhausted for https://example.com/grants
[Nest] 91242  - 01/29/2026, 8:37:18 PM   ERROR [ScraperService] ✗ GenericScraper failed: Invalid URL
[Nest] 91242  - 01/29/2026, 8:37:18 PM   ERROR [ScraperService] ✗ All scraping methods exhausted for not-a-url
[Nest] 91242  - 01/29/2026, 8:37:18 PM   ERROR [ScraperService] ✗ GenericScraper failed: Network error
[Nest] 91242  - 01/29/2026, 8:37:18 PM   ERROR [ScraperService] ✗ All scraping methods exhausted for https://example.com/grants
PASS src/scraper/__tests__/scraper.service.spec.ts (16.199 s)
[Nest] 91181  - 01/29/2026, 8:37:19 PM   ERROR [SearchService] Search failed: Database connection error
Error: Database connection error
    at Object.<anonymous> (/home/akenator/PROYECTOS/GRANTER 2.0/apps/backend-core/src/search/__tests__/search.e2e.spec.ts:319:51)
    at Promise.then.completed (/home/akenator/PROYECTOS/GRANTER 2.0/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (<anonymous>)
    at callAsyncCircusFn (/home/akenator/PROYECTOS/GRANTER 2.0/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/akenator/PROYECTOS/GRANTER 2.0/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:103:5)
    at _runTest (/home/akenator/PROYECTOS/GRANTER 2.0/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/akenator/PROYECTOS/GRANTER 2.0/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/akenator/PROYECTOS/GRANTER 2.0/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/akenator/PROYECTOS/GRANTER 2.0/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/akenator/PROYECTOS/GRANTER 2.0/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/akenator/PROYECTOS/GRANTER 2.0/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/akenator/PROYECTOS/GRANTER 2.0/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/akenator/PROYECTOS/GRANTER 2.0/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/akenator/PROYECTOS/GRANTER 2.0/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/akenator/PROYECTOS/GRANTER 2.0/node_modules/jest-runner/build/testWorker.js:106:12)
PASS src/search/__tests__/search.e2e.spec.ts (17.562 s)
PASS src/scraper/__tests__/scraper.e2e.spec.ts (17.615 s)

Test Suites: 2 skipped, 21 passed, 21 of 23 total
Tests:       114 skipped, 144 passed, 258 total
Snapshots:   0 total
Time:        18.927 s, estimated 22 s
Ran all test suites.
